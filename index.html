<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Member Management System</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js"></script>
  <style>
    @keyframes fadeInScale {
      0% { opacity: 0; transform: scale(0.9); }
      100% { opacity: 1; transform: scale(1); }
    }
    @keyframes slideDownFade {
      0% { opacity: 0; transform: translateY(-10px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    @keyframes glowPulse {
      0%,100% { text-shadow: 0 0 2px #60a5fa, 0 0 4px #9333ea; }
      50% { text-shadow: 0 0 3px #3b82f6, 0 0 6px #a855f7; }
    }
  </style>
</head>
<body class="bg-gradient-to-br from-gray-900 via-gray-800 to-black text-white min-h-screen">

  <!-- Top Bar -->
  <div class="flex justify-between items-center p-4">
    <!-- Language Switch -->
    <div class="space-x-2">
      <button onclick="setLanguage('en')" class="px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm shadow">EN</button>
      <button onclick="setLanguage('si')" class="px-3 py-1 bg-green-600 hover:bg-green-700 rounded-lg text-sm shadow">‡∑É‡∑í‡∂Ç</button>
      <button onclick="setLanguage('ta')" class="px-3 py-1 bg-pink-600 hover:bg-pink-700 rounded-lg text-sm shadow">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
    </div>

    <!-- Owner Access -->
    <div>
      <button id="ownerLoginBtn" onclick="showOwnerLogin()" 
        class="px-6 py-2 bg-gray-700 hover:bg-gray-600 rounded-xl shadow-lg animate-pulse transform hover:scale-105 transition">
        üîê <span data-i18n="ownerAccess">Owner Access</span>
      </button>
      <button id="downloadBtn" onclick="downloadSubmissions()" 
        class="px-6 py-2 bg-purple-600 hover:bg-purple-700 rounded-xl shadow-lg hidden transform hover:scale-105 transition ml-2">
        üíæ <span data-i18n="downloadData">Download Data</span>
      </button>
      <button id="clearDataBtn" onclick="clearData()" 
        class="px-6 py-2 bg-red-700 hover:bg-red-800 rounded-xl shadow-lg hidden transform hover:scale-105 transition ml-2">
        üóëÔ∏è <span data-i18n="clearData">Clear All Data</span>
      </button>
      <button id="logoutBtn" onclick="logoutOwner()" 
        class="px-6 py-2 bg-yellow-600 hover:bg-yellow-700 rounded-xl shadow-lg hidden transform hover:scale-105 transition ml-2">
        üö™ <span data-i18n="logout">Logout</span>
      </button>
    </div>
  </div>

  <!-- Main Section -->
  <div class="min-h-screen flex flex-col items-center justify-center -mt-20 text-center">
    <h1 id="mainTitle" class="text-6xl font-extrabold mb-6 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent animate-[glowPulse_2s_infinite] drop-shadow-lg">
      Member Management System
    </h1>
    
    <div class="space-x-4 mb-6">
      <button onclick="openForm()" 
        class="px-6 py-3 bg-blue-600 hover:bg-blue-700 rounded-xl shadow-lg transform hover:scale-105 transition">
        ‚ûï <span data-i18n="addMember">Add New Member</span>
      </button>
      <button onclick="window.open('https://docs.google.com/spreadsheets/d/14a39saiscm07b_0uXkm4ShB5NysLfS-RWPNoanLUppU/edit?gid=0#gid=0','_blank')" 
        class="px-6 py-3 bg-green-600 hover:bg-green-700 rounded-xl shadow-lg transform hover:scale-105 transition">
        üìÑ <span data-i18n="viewMembers">View All Members</span>
      </button>
    </div>
    
    <!-- Terms and Conditions -->
    <div class="space-x-4 mb-6">
      <a href="terms1.pdf" target="_blank" class="px-6 py-3 bg-gray-700 hover:bg-gray-600 rounded-xl shadow-lg transform hover:scale-105 transition">üìò Terms (1)</a>
      <a href="terms2.pdf" target="_blank" class="px-6 py-3 bg-gray-700 hover:bg-gray-600 rounded-xl shadow-lg transform hover:scale-105 transition">üìô Terms (2)</a>
      <a href="terms3.pdf" target="_blank" class="px-6 py-3 bg-gray-700 hover:bg-gray-600 rounded-xl shadow-lg transform hover:scale-105 transition">üìï Terms (3)</a>
    </div>

    <div id="statusDisplay" class="hidden mb-4 p-4 rounded-xl max-w-2xl w-full mx-4 animate-[slideDownFade_0.5s_ease]"></div>
  </div>

  <!-- Owner Login Modal -->
  <div id="ownerModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center hidden">
    <div class="bg-gray-800 rounded-2xl shadow-lg p-8 w-full max-w-sm relative mx-4 animate-[fadeInScale_0.3s_ease]">
      <button onclick="closeOwnerLogin()" class="absolute top-3 right-3 text-gray-400 hover:text-white text-2xl">&times;</button>
      <h2 class="text-2xl font-semibold mb-6 text-center">üîê <span data-i18n="ownerAccess">Owner Access</span></h2>
      <form id="ownerForm" class="space-y-4">
        <div>
          <label for="ownerPassword" class="block text-gray-200 font-medium mb-1" data-i18n="password">Password</label>
          <input type="password" id="ownerPassword" required placeholder="Enter owner password"
            class="w-full p-3 rounded-xl border border-gray-600 bg-gray-700 text-white focus:ring-2 focus:ring-blue-500 transition">
        </div>
        <button type="submit" class="w-full py-3 bg-blue-500 hover:bg-blue-600 rounded-xl font-semibold transform hover:scale-105 transition">
          üîì <span data-i18n="unlockFeatures">Unlock Owner Features</span>
        </button>
      </form>
    </div>
  </div>

  <!-- Add Member Modal -->
  <div id="formModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center hidden">
    <div class="bg-gray-800 rounded-2xl shadow-lg p-8 w-full max-w-lg relative mx-4 animate-[fadeInScale_0.3s_ease]">
      <button onclick="closeForm()" class="absolute top-3 right-3 text-gray-400 hover:text-white text-2xl">&times;</button>
      <h2 class="text-2xl font-semibold mb-6" data-i18n="addMember">Add Member</h2>
      <form id="memberForm" class="space-y-4">
        <div>
          <label for="name" class="block text-gray-200 font-medium mb-1" data-i18n="fullName">Full Name</label>
          <input type="text" id="name" required class="w-full p-3 rounded-xl border border-gray-600 bg-gray-700 text-white focus:ring-2 focus:ring-blue-500 transition">
        </div>
        <div>
          <label for="birthday" class="block text-gray-200 font-medium mb-1" data-i18n="birthday">Birthday</label>
          <input type="date" id="birthday" required class="w-full p-3 rounded-xl border border-gray-600 bg-gray-700 text-white focus:ring-2 focus:ring-green-500 transition">
        </div>
        <div>
          <label for="sex" class="block text-gray-200 font-medium mb-1" data-i18n="sex">Sex</label>
          <select id="sex" required class="w-full p-3 rounded-xl border border-gray-600 bg-gray-700 text-white focus:ring-2 focus:ring-purple-500 transition">
            <option value="">-- Select --</option>
            <option value="Male">Male </option>
            <option value="Female">Female </option>
            <option value="Other">Other </option>
          </select>
        </div>
        <div>
          <label for="familyMembers" class="block text-gray-200 font-medium mb-1" data-i18n="familyMembers">Family Members (one per line)</label>
          <textarea id="familyMembers" rows="4" placeholder="John - Father&#10;Mary - Mother"
            class="w-full p-3 rounded-xl border border-gray-600 bg-gray-700 text-white focus:ring-2 focus:ring-pink-500 transition"></textarea>
        </div>
        <div class="space-y-3">
          <button type="submit" class="w-full py-3 bg-blue-500 hover:bg-blue-600 rounded-xl font-semibold transform hover:scale-105 transition">
            üíæ <span data-i18n="saveLocal">Save to Database</span>
          </button>
        </div>
      </form>
    </div>
  </div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

  
  const firebaseConfig = {
    apiKey: "AIzaSyANUfgVwR0uWPOaFzf1GrehpfitR1sUGw0",
  authDomain: "project01-d5df2.firebaseapp.com",
  projectId: "project01-d5df2",
  storageBucket: "project01-d5df2.firebasestorage.app",
  messagingSenderId: "398259647179",
  appId: "1:398259647179:web:54c78c2144a5d70e58614e",
  measurementId: "G-Q1ZVC5C7LZ"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  let isOwner = false;
  const OWNER_PASSWORD = "Hasintha15$";

  // üîπ Multi-language support
  const translations = {
    en: { title:"Member Management System", ownerAccess:"Owner Access", downloadData:"Download Data", clearData:"Clear All Data", logout:"Logout", addMember:"Add New Member", viewMembers:"View All Members", password:"Password", unlockFeatures:"Unlock Owner Features", fullName:"Full Name", birthday:"Birthday", sex:"Sex", familyMembers:"Family Members (one per line)", saveLocal:"Save to Database" },
    si: { title:"‡∑É‡∑è‡∂∏‡∑è‡∂¢‡∑í‡∂ö ‡∂ö‡∑Ö‡∂∏‡∂±‡∑è‡∂ö‡∂ª‡∂´ ‡∂¥‡∂Ø‡∑ä‡∂∞‡∂≠‡∑í‡∂∫", ownerAccess:"‡∂Ö‡∂∫‡∑í‡∂≠‡∑í‡∂ö‡∂ª‡∑î ‡∂¥‡∑í‡∑Ä‡∑í‡∑É‡∑î‡∂∏", downloadData:"‡∂Ø‡∂≠‡∑ä‡∂≠ ‡∂∂‡∑è‡∂ú‡∂±‡∑ä‡∂±", clearData:"‡∂Ø‡∂≠‡∑ä‡∂≠ ‡∑É‡∑í‡∂∫‡∂Ω‡∑ä‡∂Ω ‡∂∏‡∂ö‡∂±‡∑ä‡∂±", logout:"‡∂±‡∑í‡∂ö‡∑ä‡∂∏‡∑ô‡∂±‡∑ä‡∂±", addMember:"‡∂±‡∑Ä ‡∑É‡∑è‡∂∏‡∑è‡∂¢‡∑í‡∂ö‡∂∫‡∑ô‡∂ö‡∑î ‡∂ë‡∂ö‡∂≠‡∑î ‡∂ö‡∂ª‡∂±‡∑ä‡∂±", viewMembers:"‡∑É‡∑í‡∂∫‡∂Ω‡∑î ‡∑É‡∑è‡∂∏‡∑è‡∂¢‡∑í‡∂ö‡∂∫‡∑í‡∂±‡∑ä ‡∂∂‡∂Ω‡∂±‡∑ä‡∂±", password:"‡∂∏‡∑î‡∂ª‡∂¥‡∂Ø‡∂∫", unlockFeatures:"‡∂Ö‡∂∫‡∑í‡∂≠‡∑í‡∂ö‡∂ª‡∑î‡∂ú‡∑ö ‡∑Ä‡∑í‡∑Å‡∑ö‡∑Ç‡∑è‡∂Ç‡∂ú ‡∂Ö‡∂ú‡∑î‡∂Ω‡∑î ‡∑Ñ‡∂ª‡∑í‡∂±‡∑ä‡∂±", fullName:"‡∑É‡∂∏‡∑ä‡∂¥‡∑ñ‡∂ª‡∑ä‡∂´ ‡∂±‡∂∏", birthday:"‡∂ã‡∂¥‡∂±‡∑ä‡∂Ø‡∑í‡∂±‡∂∫", sex:"‡∑É‡∑ä‡∂≠‡∑ä‚Äç‡∂ª‡∑ì/‡∂¥‡∑î‡∂ª‡∑î‡∑Ç ‡∂∑‡∑è‡∑Ä‡∂∫", familyMembers:"‡∂ö‡µÅ‡¥ü‡µÅ‡¥Ç‡¥¨ ‡∑É‡∑è‡∂∏‡∑è‡∂¢‡∑í‡∂ö‡∂∫‡∑í‡∂±‡∑ä (‡∂¥‡∑ö‡∑Ö‡∑í‡∂∫‡∂ö‡∂ß ‡∂ë‡∂ö‡∂ö‡∑ä)", saveLocal:"‡∂Ø‡∂≠‡∑ä‡∂≠ ‡∑É‡∂∏‡∑î‡∂Ø‡∑è‡∂ú‡∂≠ ‡∂ö‡∂ª‡∂±‡∑ä‡∂±" },
    ta: { title:"‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç ‡ÆÆ‡Øá‡Æ≤‡Ææ‡Æ£‡Øç‡ÆÆ‡Øà ‡ÆÖ‡ÆÆ‡Øà‡Æ™‡Øç‡Æ™‡ØÅ", ownerAccess:"‡Æâ‡Æ∞‡Æø‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç ‡ÆÖ‡Æ£‡ØÅ‡Æï‡Æ≤‡Øç", downloadData:"‡Æ§‡Æ∞‡Æµ‡ØÅ ‡Æ™‡Æ§‡Æø‡Æµ‡Æø‡Æ±‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç", clearData:"‡ÆÖ‡Æ©‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ‡Æ§‡Æ∞‡Æµ‡Øà‡ÆØ‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡Æ¥‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç", logout:"‡Æµ‡ØÜ‡Æ≥‡Æø‡ÆØ‡Øá‡Æ±‡ØÅ", addMember:"‡Æ™‡ØÅ‡Æ§‡Æø‡ÆØ ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øà‡Æö‡Øç ‡Æö‡Øá‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç", viewMembers:"‡ÆÖ‡Æ©‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡Øà‡ÆØ‡ØÅ‡ÆÆ‡Øç ‡Æï‡Ææ‡Æ£‡Øç‡Æï", password:"‡Æï‡Æü‡Æµ‡ØÅ‡Æö‡Øç‡Æö‡Øä‡Æ≤‡Øç", unlockFeatures:"‡Æâ‡Æ∞‡Æø‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç ‡ÆÖ‡ÆÆ‡Øç‡Æö‡Æô‡Øç‡Æï‡Æ≥‡Øà‡Æ§‡Øç ‡Æ§‡Æø‡Æ±‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç", fullName:"‡ÆÆ‡ØÅ‡Æ¥‡ØÅ ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç", birthday:"‡Æ™‡Æø‡Æ±‡Æ®‡Øç‡Æ§‡Æ®‡Ææ‡Æ≥‡Øç", sex:"‡Æ™‡Ææ‡Æ≤‡Æø‡Æ©‡ÆÆ‡Øç", familyMembers:"‡Æï‡ØÅ‡Æü‡ØÅ‡ÆÆ‡Øç‡Æ™ ‡Æâ‡Æ±‡ØÅ‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Æ∞‡Øç‡Æï‡Æ≥‡Øç (‡Æí‡Æ©‡Øç‡Æ±‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æí‡Æ∞‡ØÅ ‡Æµ‡Æ∞‡Æø)", saveLocal:"‡Æ§‡Æ∞‡Æµ‡Øà‡Æö‡Øç ‡Æö‡Øá‡ÆÆ‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç" }
  };

  function setLanguage(lang) {
    document.getElementById("mainTitle").textContent = translations[lang].title;
    document.querySelectorAll("[data-i18n]").forEach(el => {
      const key = el.getAttribute("data-i18n");
      el.textContent = translations[lang][key];
    });
  }

  function showStatus(msg, success=true){
    const d=document.getElementById('statusDisplay');
    d.className=`mb-4 p-4 rounded-xl max-w-2xl w-full mx-4 animate-[slideDownFade_0.5s_ease] ${success?'bg-green-600':'bg-red-600'}`;
    d.textContent=msg;
    d.classList.remove('hidden');
    setTimeout(()=>d.classList.add('hidden'),5000);
  }

  document.getElementById("memberForm").addEventListener("submit",async e=>{
    e.preventDefault();
    const data={
      name:document.getElementById("name").value,
      birthday:document.getElementById("birthday").value,
      sex:document.getElementById("sex").value,
      family:document.getElementById("familyMembers").value,
      timestamp:new Date().toISOString()
    };
    try{
      await addDoc(collection(db,"members"),data);
      showStatus(`‚úÖ Member "${data.name}" saved!`);
      e.target.reset(); closeForm();
    }catch(err){ showStatus("‚ùå Failed to save",false);}
  });

  async function downloadSubmissions(){
    if(!isOwner)return showStatus("‚ùå Owner login required",false);
    const snap=await getDocs(collection(db,"members"));
    let arr=[]; snap.forEach(doc=>arr.push(doc.data()));
    if(arr.length===0)return showStatus("üìù No data",false);
    const blob=new Blob([JSON.stringify(arr,null,2)],{type:'application/json'});
    const url=URL.createObjectURL(blob);
    const a=document.createElement('a');a.href=url;a.download="member_data.json";a.click();
    URL.revokeObjectURL(url);
    showStatus(`üíæ Downloaded ${arr.length} records!`);
  }

  async function clearData(){
    if(!isOwner)return showStatus("‚ùå Owner login required",false);
    if(!confirm("‚ö†Ô∏è Clear ALL data?"))return;
    const snap=await getDocs(collection(db,"members"));
    for(const d of snap.docs){await deleteDoc(doc(db,"members",d.id));}
    showStatus("üóëÔ∏è All member data cleared!");
  }

  function showOwnerLogin(){document.getElementById("ownerModal").classList.remove("hidden");}
  function closeOwnerLogin(){document.getElementById("ownerModal").classList.add("hidden");document.getElementById("ownerPassword").value="";}

  document.getElementById("ownerForm").addEventListener("submit",e=>{
    e.preventDefault();
    const pw=document.getElementById("ownerPassword").value;
    if(pw===OWNER_PASSWORD){isOwner=true;showOwnerFeatures();showStatus("üîì Owner access granted!");closeOwnerLogin();}
    else showStatus("‚ùå Incorrect password.",false);
  });

  function showOwnerFeatures(){
    ["downloadBtn","clearDataBtn","logoutBtn"].forEach(id=>document.getElementById(id).classList.remove("hidden"));
    document.getElementById("ownerLoginBtn").classList.add("hidden");
  }
  function hideOwnerFeatures(){
    ["downloadBtn","clearDataBtn","logoutBtn"].forEach(id=>document.getElementById(id).classList.add("hidden"));
    document.getElementById("ownerLoginBtn").classList.remove("hidden");
  }
  function logoutOwner(){isOwner=false;hideOwnerFeatures();showStatus("üö™ Logged out");}

  function openForm(){document.getElementById("formModal").classList.remove("hidden");}
  function closeForm(){document.getElementById("formModal").classList.add("hidden");}

</script>
</body>
</html>
