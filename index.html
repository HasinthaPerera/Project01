<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Member Management</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    // ✅ Initialize EmailJS
    (function() {
      emailjs.init("tJyzNke0fsVsl0czT"); 
    })();
  </script>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col items-center justify-center">

  <!-- Main Section -->
  <h1 class="text-3xl font-bold mb-6">👥 Member Management</h1>
  
  <div class="space-x-4">
    <button onclick="openForm()" 
      class="px-6 py-3 bg-blue-600 hover:bg-blue-700 rounded-xl shadow-lg">
      ➕ Add New Member
    </button>
    <button onclick="window.open('https://docs.google.com/spreadsheets/d/14a39saiscm07b_0uXkm4ShB5NysLfS-RWPNoanLUppU/edit?gid=0#gid=0','_blank')" 
      class="px-6 py-3 bg-green-600 hover:bg-green-700 rounded-xl shadow-lg">
      📄 View All Members
    </button>
  </div>

  <!-- Modal (hidden by default) -->
  <div id="formModal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center hidden">
    <div class="bg-gray-800 rounded-2xl shadow-lg p-8 w-full max-w-lg relative">
      <button onclick="closeForm()" 
        class="absolute top-3 right-3 text-gray-400 hover:text-white text-2xl">&times;</button>
      
      <h2 class="text-2xl font-semibold mb-6">Add Member</h2>
      
      <form id="memberForm" class="space-y-4">
        <!-- Name -->
        <div>
          <label for="name" class="block text-gray-200 font-medium mb-1">Full Name</label>
          <input type="text" id="name" name="name" required 
            class="w-full p-3 rounded-xl border border-gray-600 bg-gray-700 text-white">
        </div>

        <!-- Birthday -->
        <div>
          <label for="birthday" class="block text-gray-200 font-medium mb-1">Birthday</label>
          <input type="date" id="birthday" name="birthday" required 
            class="w-full p-3 rounded-xl border border-gray-600 bg-gray-700 text-white">
        </div>

        <!-- Sex -->
        <div>
          <label for="sex" class="block text-gray-200 font-medium mb-1">Sex</label>
          <select id="sex" name="sex" required 
            class="w-full p-3 rounded-xl border border-gray-600 bg-gray-700 text-white">
            <option value="">-- Select --</option>
            <option value="Male">Male ♂️</option>
            <option value="Female">Female ♀️</option>
            <option value="Other">Other ⚧️</option>
          </select>
        </div>

        <!-- Family Members -->
        <div>
          <label for="familyMembers" class="block text-gray-200 font-medium mb-1">
            Family Members (one per line, format: Name - Relation)
          </label>
          <textarea id="familyMembers" name="family" rows="4" 
            placeholder="John - Father&#10;Mary - Mother" 
            class="w-full p-3 rounded-xl border border-gray-600 bg-gray-700 text-white"></textarea>
        </div>

        <!-- Submit -->
        <button type="submit" 
          class="w-full py-3 bg-blue-500 hover:bg-blue-600 rounded-xl font-semibold">
          🚀 Submit
        </button>
      </form>
    </div>
  </div>

  <script>
    // Show & Hide Modal
    function openForm() {
      document.getElementById("formModal").classList.remove("hidden");
    }
    function closeForm() {
      document.getElementById("formModal").classList.add("hidden");
    }

    // Form Submission
    document.getElementById("memberForm").addEventListener("submit", function(event) {
      event.preventDefault();

      const templateParams = {
        member_name: document.getElementById("name").value,
        member_birthday: document.getElementById("birthday").value,
        member_sex: document.getElementById("sex").value,
        member_family: document.getElementById("familyMembers").value
      };

      emailjs.send("service_hasintha15", "template_heshan15", templateParams)
        .then(() => {
          alert("✅ Member details sent successfully!");
          document.getElementById("memberForm").reset();
          closeForm();
        })
        .catch((error) => {
          console.error("EmailJS Error:", error);
          alert("❌ Failed to send email. Please check console for details.");
        });
    });
  </script>

</body>
</html>
